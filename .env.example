# Tinpot Environment Configuration
# Copy this file to .env and adjust values for your deployment

# ===================================
# Common Configuration (All Services)
# ===================================

# Redis connection URL
# Format: redis://[user:password@]host:port/db
REDIS_URL=redis://localhost:6379/0

# Directory containing action modules
ACTIONS_DIR=/opt/tinpot/actions


# ===================================
# API Server Configuration
# ===================================

# Subpath deployment (leave empty for root path)
# Example: /tinpot for deployment at https://example.com/tinpot/
ROOT_PATH=

# Server host binding
HOST=0.0.0.0

# Server port
PORT=8000

# Number of Uvicorn worker processes
# Recommendation: (2 x CPU cores) + 1
WORKERS=4

# Log level (debug, info, warning, error, critical)
LOG_LEVEL=info


# ===================================
# Worker Configuration
# ===================================

# Worker concurrency (number of concurrent tasks)
# Recommendation: CPU cores * 2
WORKER_CONCURRENCY=4

# Action groups filter (comma-separated)
# Leave empty to process all actions
# Example: devops,maintenance
ACTION_GROUPS=

# Worker queue name (for multi-worker setups)
# Default: celery (processes all queues)
# Specific: devops (only processes devops queue)
WORKER_QUEUE=celery

# Worker log level
WORKER_LOG_LEVEL=info


# ===================================
# Docker Compose Specific
# ===================================

# Set this when using docker-compose for subpath deployment
# Example: docker-compose up with ROOT_PATH=/tinpot
# Leave empty for root path deployment


# ===================================
# Production Specific
# ===================================

# Redis password (strongly recommended for production)
# REDIS_URL=redis://:your-strong-password@redis-host:6379/0

# SSL/TLS Configuration (handled by Nginx)
# See DEPLOYMENT.md for nginx SSL configuration

# Monitoring endpoints
# Health check: http://api-host:8000/health
# Readiness check: http://api-host:8000/ready


# ===================================
# Advanced Configuration
# ===================================

# Celery broker connection retry settings
# BROKER_CONNECTION_RETRY_ON_STARTUP=true

# Result backend (optional, for storing task results)
# CELERY_RESULT_BACKEND=redis://localhost:6379/1

# Task time limits (in seconds)
# CELERY_TASK_SOFT_TIME_LIMIT=3600
# CELERY_TASK_TIME_LIMIT=3900

# Celery worker pool type
# Options: prefork (default), solo, gevent, eventlet
# CELERY_WORKER_POOL=prefork


# ===================================
# Development Settings
# ===================================

# Enable debug mode (DO NOT use in production)
# DEBUG=false

# Enable auto-reload on code changes
# RELOAD=false

# Detailed Celery logging
# CELERY_WORKER_LOG_FORMAT='[%(asctime)s: %(levelname)s/%(processName)s] %(message)s'
